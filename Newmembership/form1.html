<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ಶ್ರೀ ದುರ್ಗಾಪರಮೇಶ್ವರಿ ಸೇವಾ ಟ್ರಸ್ಟ್(R ) ಹೊಸ ಸದಸ್ಯತ್ವ ಅರ್ಜಿ</title>
  <style>
    .form-container, .preview-container { max-width: 500px; margin: auto; }
    .hidden { display: none; } body {
      font-family: Arial, sans-serif;
      margin: 20px;
      padding: 20px;
      background-color: #f7f7f7;
    }
    h3, label, h4 {
      font-family: Arial, sans-serif;
      color: purple;
    }
    img {
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
    form {
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      width: 100%;
      max-width: 600px;
      margin: auto;
    }
    h2 {
      text-align: center;
      color: green;
    }
    label {
      font-size: 12px;
      display: block;
    }
    input, select {
      width: 100%;
      padding: 8px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }
    button {
      background-color: #4CAF50;
      color: white;
      padding: 10px 15px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      width: 100%;
    }
    button:hover {
      background-color: #45a049;
    }
    #loadingMessage {
      display: none;
      text-align: center;
      margin-top: 20px;
      font-size: 16px;
      color: green;
    }
    .hourglass, .hourglass:before, .hourglass:after {
	animation-duration: 4s;
	animation-iteration-count: infinite;
}
.hourglass {
	--polygonH: polygon(0% 0%,100% 0%,100% 5.55%,95% 5.55%,95% 28%,60% 46%,60% 54%,95% 72%,95% 94.45%,100% 94.45%,100% 100%,0% 100%,0% 94.45%,5% 94.45%,5% 72%,40% 54%,40% 46%,5% 28%,5% 5.55%,0% 5.55%);
	animation-name: flip;
	animation-timing-function: ease-in-out;
	background-image: linear-gradient(var(--primary) 0.5em,#737a8c55 0.5em 8.5em,var(--primary) 8.5em);
	clip-path: var(--polygonH);
	-webkit-clip-path: var(--polygonH);
	overflow: hidden;
	position: relative;
	width: 5em;
	height: 9em;
	z-index: 0;
}
.hourglass:before, .hourglass:after {
	animation-timing-function: linear;
	content: "";
	display: block;
	position: absolute;
}
.hourglass:before {
	--polygonB1: polygon(0% 0%,100% 0%,100% 24%,50% 47%,50% 47%,50% 47%,50% 47%,50% 47%,50% 47%,50% 47%,50% 47%,0% 24%);
	--polygonB2: polygon(0% 4%,100% 4%,100% 24%,55% 45%,55% 100%,55% 100%,55% 100%,45% 100%,45% 100%,45% 100%,45% 45%,0% 24%);
	--polygonB3: polygon(0% 24%,100% 24%,100% 24%,55% 45%,55% 80%,100% 100%,100% 100%,0% 100%,0% 100%,45% 80%,45% 45%,0% 24%);
	--polygonB4: polygon(45% 45%,55% 45%,55% 45%,55% 45%,55% 58%,100% 76%,100% 100%,0% 100%,0% 76%,45% 58%,45% 45%,45% 45%);
	--polygonB5: polygon(50% 53%,50% 53%,50% 53%,50% 53%,50% 53%,100% 76%,100% 100%,0% 100%,0% 76%,50% 53%,50% 53%,50% 53%);
	animation-name: fill;
	background-color: var(--fg);
	background-size: 100% 3.6em;
	clip-path: var(--polygonB1);
	-webkit-clip-path: var(--polygonB1);
	top: 0.5em;
	left: 0.5em;
	width: 4em;
	height: 8em;
	z-index: 1;
}
.hourglass:after {
	animation-name: glare;
	background:
		linear-gradient(90deg,#0000 0.5em,#0003 0.5em 1.5em,#0000 1.5em 3.5em,#fff3 3.5em 4.5em,#fff0 4.5em 6.5em,#0003 6.5em 7.5em,#0000 7.5em) 0 0 / 100% 0.5em,
		linear-gradient(90deg,#0000 0.75em,#0003 0.75em 1.25em,#0000 1.25em 3.75em,#fff3 3.75em 4.25em,#fff0 4.25em 6.75em,#0003 6.75em 7.25em,#0000 7.25em) 0 0.5em / 100% 8em,
		linear-gradient(90deg,#0000 0.5em,#0003 0.5em 1.5em,#0000 1.5em 3.5em,#fff3 3.5em 4.5em,#fff0 4.5em 6.5em,#0003 6.5em 7.5em,#0000 7.5em) 0 100% / 100% 0.5em;
	background-repeat: repeat-x;
	top: 0;
	left: -3em;
	width: 200%;
	height: 100%;
	z-index: 2;
}
/* Animations */
@keyframes fill {
	from {
		clip-path: var(--polygonB1);
		-webkit-clip-path: var(--polygonB1);
	}
	10% {
		clip-path: var(--polygonB2);
		-webkit-clip-path: var(--polygonB2);
	}
	45% {
		clip-path: var(--polygonB3);
		-webkit-clip-path: var(--polygonB3);
	}
	80% {
		clip-path: var(--polygonB4);
		-webkit-clip-path: var(--polygonB4);
	}
	85%, to {
		clip-path: var(--polygonB5);
		-webkit-clip-path: var(--polygonB5);
	}
}
@keyframes glare {
	from, 90% {
		transform: translateX(0);
	}
	to {
		transform: translateX(3em);
	}
}
@keyframes flip {
	from, 90% {
		transform: rotate(0);
	}
	to {
		transform: rotate(180deg);
	}
}
/* Dark mode */
@media (prefers-color-scheme: dark) {
	:root {
		--bg: #17181c;
		--fg: #c7cad1;
	}
}
@keyframes fadeInOut {
      0%, 100% {
        opacity: 1;
      }
      50% {
        opacity: 0.5;
      }
    }
.loading-text {
      margin-top: 20px;
      font-size: 18px;
      font-weight: 500;
      animation: fadeInOut 2s infinite;
    }
    img { max-width: 100%; height: auto; margin-top: 10px; }
     body {
      font-family: Arial, sans-serif;
      margin: 20px;
      padding: 20px;
      background-color: #f7f7f7;
    }
    h3, label, h4 {
      font-family: Arial, sans-serif;
      color: purple;
    }
    * {
	border: 0;
	box-sizing: border-box;
	margin: 0;
	padding: 0;

}
:root {
	--bg: #e3e4e8;
	--fg: #2e3138;
	--primary: #255ff4;
	font-size: calc(16px + (24 - 16) * (100vw - 320px) / (1280 - 320));
}
    img {
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
    form {
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      width: 100%;
      max-width: 600px;
      margin: auto;
    }
    h2 {
      text-align: center;
      color: green;
    }
    label {
      font-size: 12px;
      display: block;
    }
    input, select, textarea {
      width: 100%;
      padding: 8px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }
    button {
      background-color: #4CAF50;
      color: white;
      padding: 10px 15px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      width: 100%;
    }
    button:hover {
      background-color: #45a049;
    }
    #loading {
        place-items: center;
}
    #loadingMessage {
      display: none;
      text-align: center;
      margin-top: 20px;
      font-size: 16px;
      color: green;
    }
  </style>
</head>
<body>
  <div class="form-container " id="detailsFormContainer">
    <h2>ಶ್ರೀ ದುರ್ಗಾಪರಮೇಶ್ವರಿ ಸೇವಾ ಟ್ರಸ್ಟ್(R) - ಹೊಸ ಸದಸ್ಯತ್ವ ಅರ್ಜಿ</h2>
    <form id="detailsForm" method="POST" enctype="multipart/form-data">
    <input type="hidden" name="action" value="newmbrshp">
     <label for="name">ಹೆಸರು:</label>
    <input type="text" id="name" name="name" required><br>

    <br><label for="mobile">ಮೊಬೈಲ್ ಸಂಖ್ಯೆ:</label>
    <input type="number" id="mobile" name="mobile" required><br><br>
<label for="email">ಇಮೇಲ್ ವಿಳಾಸ(ಕಡ್ಡಾಯವಿಲ್ಲ. ಆದರೆ ಸದಸ್ಯತ್ವ ಕಾರ್ಡನ್ನು ಪಡೆಯಲು ಇದನ್ನು ಸೇರಿಸಲು ಶಿಫಾರಸ್ಸು ಮಾಡುತ್ತೇವೆ ):</label>
    <input type="email" id="email" name="email"><br><br>
      
   <label for="address">ವಿಳಾಸ:</label>
    <textarea id="address" name="address" rows="4" required></textarea><br><br>
        <label for="gotra">ಗೋತ್ರ :</label>
    <select type="text" id="gotra" name="gotra">
                    <option value="ವಿಶ್ವಾಮಿತ್ರ">ವಿಶ್ವಾಮಿತ್ರ</option>
                    <option value="ಭಾರದ್ವಾಜ">ಭಾರದ್ವಾಜ</option>
                    <option value="ವಸಿಷ್ಠ">ವಸಿಷ್ಠ</option>
                    <option value="ಅತ್ರಿ">ಅತ್ರಿ</option>
                    <option value="ಗೌತಮ">ಗೌತಮ</option>
                    <option value="ಕಶ್ಯಪ">ಕಶ್ಯಪ</option>
                    <option value="ಕೌಂಡಿನ್ಯ">ಕೌಂಡಿನ್ಯ</option>
                    <option value="ಕೌಶಿಕ">ಕೌಶಿಕ</option>
                    <option value="ವತ್ಸ">ವತ್ಸ</option>
                </select>
      
      <br><br>
     <label for="raashi">ರಾಶಿ:</label>
      <select type="text" id="raashi" name="raashi">
                    <option value="ಮೇಷ">ಮೇಷ</option>
                    <option value="ವೃಷಭ">ವೃಷಭ</option>
                    <option value="ಮಿಥುನ">ಮಿಥುನ</option>
                    <option value="ಕಟಕ">ಕಟಕ</option>
                    <option value="ಸಿಂಹ">ಸಿಂಹ</option>
                    <option value="ಕನ್ಯಾ">ಕನ್ಯಾ</option>
                    <option value="ತುಲಾ">ತುಲಾ</option>
                    <option value="ವೃಶ್ಚಿಕ">ವೃಶ್ಚಿಕ</option>
                    <option value="ಧನು">ಧನು</option>
                    <option value="ಮಕರ">ಮಕರ</option>
                    <option value="ಕುಂಭ">ಕುಂಭ</option>
                    <option value="ಮೀನ">ಮೀನ</option>
                </select><br><br>
                <label for="nakshatra">ನಕ್ಷತ್ರ :</label>
                <select type="text" id="nakshatra" name="nakshatra">
                    <option value="ಅಶ್ವಿನಿ">ಅಶ್ವಿನಿ</option>
                    <option value="ಭರಣಿ">ಭರಣಿ</option>
                    <option value="ಕೃತಿಕಾ">ಕೃತಿಕಾ</option>
                    <option value="ರೋಹಿಣಿ">ರೋಹಿಣಿ</option>
                    <option value="ಮೃಗಶಿರ">ಮೃಗಶಿರ</option>
                    <option value="ಆರ್ದ್ರಾ">ಆರ್ದ್ರಾ (ಆರಿದ್ರಾ)</option>
                    <option value="ಪುನರ್ವಸು">ಪುನರ್ವಸು</option>
                    <option value="ಪುಷ್ಯ">ಪುಷ್ಯ</option>
                    <option value="ಆಶ್ಲೇಷ">ಆಶ್ಲೇಷ</option>
                    <option value="ಮಘಾ">ಮಘಾ</option>
                    <option value="ಪುಬ್ಬ">ಪುಬ್ಬ (ಪೂರ್ವ ಫಲ್ಗುಣಿ)</option>
                    <option value="ಉತ್ತರಾ">ಉತ್ತರಾ (ಉತ್ತರ ಫಲ್ಗುಣಿ)</option>
                    <option value="ಹಸ್ತ">ಹಸ್ತ</option>
                    <option value="ಚಿತ್ತಾ">ಚಿತ್ತಾ ನಕ್ಷತ್ರ</option>
                    <option value="ಸ್ವಾತಿ">ಸ್ವಾತಿ</option>
                    <option value="ವಿಶಾಖ">ವಿಶಾಖ</option>
                    <option value="ಅನುರಾಧ">ಅನುರಾಧ</option>
                    <option value="ಜ್ಯೇಷ್ಠ">ಜ್ಯೇಷ್ಠ</option>
                    <option value="ಮೂಲ">ಮೂಲ</option>
                    <option value="ಪೂರ್ವಾಷಾಡಾ">ಪೂರ್ವಾಷಾಡಾ</option>
                    <option value="ಉತ್ತರಾಷಾಡಾ">ಉತ್ತರಾಷ್ಟಾ</option>
                    <option value="ಶ್ರವಣ">ಶ್ರವಣ</option>
                    <option value="ಧನಿಷ್ಠ">ಧನಿಷ್ಠ</option>
                    <option value="ಶತಭಿಷ">ಶತಭಿಷ</option>
                    <option value="ಪೂರ್ವಭಾದ್ರ">ಪೂರ್ವಭಾದ್ರ</option>
                    <option value="ಉತ್ತರಭಾದ್ರ">ಉತ್ತರಭಾದ್ರ</option>
                    <option value="ರೇವತಿ">ರೇವತಿ</option>
                </select><br><br>
      
      <label for="dob">ಜನ್ಮ ದಿನಾಂಕ:</label>
    <input type="date" id="dob" name="dob" required><br><br>
      
                <label for="ks">ಕುಟುಂಬ ಸ್ಥಳ: </label>
                 <select type="text" id="ks" name="ks">
      <option value="ಹಳ್ಳಿಮನೆ">ಹಳ್ಳಿಮನೆ</option>
                    <option value="ಕೆರೋಡಿ">ಕೆರೋಡಿ</option>
                    <option value="ಕೆಳಂಗಡಿ">ಕೆಳಂಗಡಿ </option>
                    <option value="ವಿಶ್ವನಾಥಪುರ">ವಿಶ್ವನಾಥಪುರ</option>
                    <option value="ಕೆರೆದಂಡೆ ">ಕೆರೆದಂಡೆ </option>
                    <option value="ಮುತ್ತುಗೋಡು">ಮುತ್ತುಗೋಡು</option>
                    <option value="ಮಾಗಲು">ಮಾಗಲು</option>
                    <option value="ನಿಡದಳ್ಳಿ ">ನಿಡದಳ್ಳಿ   </option>
                                    </select>
      
      <br><br>
      <label for="membershipAmount">ಸದಸ್ಯತ್ವ ಶುಲ್ಕ :</label>
    <input type="text" id="membershipAmount" name="membershipAmount" value="1000" readonly><br><br>
<label>ಭಾವಚಿತ್ರ:</label>      <input type="file" id="photoInput" accept="image/*" required><br><br>
      

      

      
      <button type="button" id="previewButton">Preview</button>
    </form>
  </div>

  <div class="preview-container hidden" id="previewContainer" style="color:#5d1000">
    <h2>Form Preview</h2>
    <form id="previewForm">
      <p><strong>ಹೆಸರು:</strong> <span id="previewName"></span></p>
      <p><strong>ಮೊಬೈಲ್ ಸಂಖ್ಯೆ:</strong> <span id="previewMobile"></span></p>
      <p><strong>ಇಮೇಲ್ ವಿಳಾಸ:</strong> <span id="previewEmail"></span></p>
      <p><strong>ವಿಳಾಸ:</strong> <span id="previewAddress"></span></p>
      <p><strong>ಗೋತ್ರ:</strong> <span id="previewGotra"></span></p>
      <p><strong>ರಾಶಿ:</strong> <span id="previewRaashi"></span></p>
      <p><strong>ನಕ್ಷತ್ರ:</strong> <span id="previewNakshtra"></span></p>
      <p><strong>ಜನ್ಮ ದಿನಾಂಕ:</strong> <span id="previewDOB"></span></p>
      <p><strong>ಕುಟುಂಬ ಸ್ಥಳ:</strong> <span id="previewKutumbaStala"></span></p>
      <p><strong>ಸದಸ್ಯತ್ವ ಶುಲ್ಕ:</strong> 1000 <span id="previewmembershipamount"></span></p>
       <input type="hidden" name="action" value="newmbrshptest">
      <input type="hidden" name="pname" id="pname">
      <input type="hidden" name="paddress" id="paddress">
     <input type="hidden" name="pemail" id="pemail">
       <input type="hidden" name="pmobile" id="pmobile">
        <input type="hidden" name="pgotra" id="pgotra">
    <input type="hidden" name="pks" id="pks">
<input type="hidden" name="praashi" id="praashi">
<input type="hidden" name="pnakshatra" id="pnakshatra">
<input type="hidden" name="pdob" id="pdob">
      <p><strong>Photo:</strong></p>
      <img id="previewPhoto" alt="Compressed Photo">
      <input type="hidden" name="photo" id="compressedPhotoData">
      <br><br>
      <button type="submit" id="submitButton">Submit</button>
    </form>
     

  </div>
  <div class="loading hidden" id="loading">
    <p class="hourglass"></p>
 <p class="loading-text">ದಯವಿಟ್ಟು ನಿರೀಕ್ಷಿಸಿ, ನಾವು ನಿಮ್ಮ ವಿನಂತಿಯನ್ನು ಪ್ರಕ್ರಿಯೆಗೊಳಿಸುತ್ತಿದ್ದೇವೆ...</p>
    </div>
  <div class="rp hidden" id="rp">
 <p id="response"></p>
    </div>
  <script>
    const previewButton = document.getElementById("previewButton");
    const photoInput = document.getElementById("photoInput");
    const detailsFormContainer = document.getElementById("detailsFormContainer");
    const previewContainer = document.getElementById("previewContainer");

    previewButton.addEventListener("click", () => {
      event.preventDefault();
      let isValid = true;
      const name = document.getElementById('name').value;
  if (!name) {
    alert("ಹೆಸರು ನಮೂದಿಸಿ!");
    isValid = false;
  }
  

  const address = document.getElementById('address').value;
  if (!address) {
    alert("ವಿಳಾಸ ನಮೂದಿಸಿ!");
    isValid = false;
  }

  const mobile = document.getElementById('mobile').value;
  if (!mobile) {
    alert("ಮೊಬೈಲ್ ಸಂಖ್ಯೆ ನಮೂದಿಸಿ!");
    isValid = false;
  }
const dob = document.getElementById('dob').value;
  if (!dob) {
    alert("ಜನ್ಮ ದಿನಾಂಕ ನಮೂದಿಸಿ!");
    isValid = false;
  }
  
  const photo = document.getElementById('photoInput').files.length;
  if (photo === 0) {
    alert("ಭಾವಚಿತ್ರ ಸೇರಿಸಿ!");
    isValid = false;
  }

  if (!isValid) return;

 const form = document.getElementById("detailsForm");

document.getElementById("previewName").innerText = form.name.value;
            document.getElementById("pname").value = form.name.value;

      document.getElementById("previewEmail").innerText = form.email.value;
            document.getElementById("pemail").value = form.email.value;

      document.getElementById("previewAddress").innerText = form.address.value;
      document.getElementById("paddress").value = form.address.value;
      document.getElementById("previewRaashi").innerText = form.raashi.value;
      document.getElementById("praashi").value = form.raashi.value;
      document.getElementById("previewNakshtra").innerText = form.nakshatra.value;
       document.getElementById("pnakshatra").value = form.nakshatra.value;
      document.getElementById("previewDOB").innerText = form.dob.value;
            document.getElementById("pdob").value = form.dob.value;

      document.getElementById("previewGotra").innerText = form.gotra.value;
            document.getElementById("pgotra").value = form.gotra.value;

      document.getElementById("previewKutumbaStala").innerText = form.ks.value;
            document.getElementById("pks").value = form.ks.value;

      document.getElementById("previewMobile").innerText = form.mobile.value;
            document.getElementById("pmobile").value = form.mobile.value;


      const file = photoInput.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(event) {
          const img = new Image();
          img.onload = function() {
            const canvas = document.createElement("canvas");
            const ctx = canvas.getContext("2d");

            canvas.width = 300; 
            canvas.height = 300;

            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
            const compressedData = canvas.toDataURL("image/jpeg", 0.2);

            document.getElementById("previewPhoto").src = compressedData;

            document.getElementById("compressedPhotoData").value = compressedData;
          };
          img.src = event.target.result;
        };
        reader.readAsDataURL(file);
      }

      detailsFormContainer.classList.add("hidden");
      previewContainer.classList.remove("hidden");
    });
    
     async function loadConfig() {
      const response = await fetch('https://raw.githubusercontent.com/sandeephallimane/durgaparameshwarisevatrust/main/config.json');
      const config = await response.json();
      document.getElementById('previewForm').action = config.googleScriptUrl;
    }

    const form1 = document.getElementById('previewForm');
    const responseParagraph = document.getElementById('response');

    form1.addEventListener('submit', async (e) => {
      e.preventDefault();
       const pc = document.getElementById("previewContainer");
       const ld = document.getElementById("loading");
        const rp = document.getElementById("rp");

      pc.classList.add("hidden");
      ld.classList.remove("hidden");      
      const formData1 = new FormData(form1);
      const data1 = Object.fromEntries(formData1.entries());

      try {
        const res = await fetch('/api/proxy', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ data1 })
        });

        if (!res.ok) {
          throw new Error('Error submitting data');
        }

        const result1 = await res.json();
       if (result1.link) {
    window.location.href = result1.link; 
  } else {
    responseParagraph.textContent = 'No link received in the response.';
    ld.classList.add("hidden");
    rp.classList.remove("hidden");   
  }
} catch (error) {
  responseParagraph.textContent = `Error: ${error.message}`;
    ld.classList.add("hidden");
    rp.classList.remove("hidden");  
}
    });
    window.onload = function(){
        loadConfig();
    }
  </script>
</body>
</html>
